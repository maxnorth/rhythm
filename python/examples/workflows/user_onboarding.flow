// User onboarding workflow with conditional paths
// Demonstrates complex conditions with && and || operators

workflow(ctx, inputs) {
  // Create user account
  let user = await Task.run("create_user_account", {
    email: inputs.email,
    name: inputs.name
  })

  // Check if user is eligible for premium features
  if (inputs.referralCode != null && inputs.signupSource == "partner") {
    // Premium onboarding path
    await Task.run("activate_premium_trial", { userId: user.id })
    await Task.run("assign_account_manager", { userId: user.id })
    await Task.run("send_premium_welcome", { email: inputs.email })
  } else {
    // Standard onboarding path
    await Task.run("send_standard_welcome", { email: inputs.email })
  }

  // Check user region for localized setup
  if (inputs.country == "US" || inputs.country == "CA") {
    await Task.run("setup_north_america_features", { userId: user.id })
  } else {
    if (inputs.country == "GB" || inputs.country == "FR" || inputs.country == "DE") {
      await Task.run("setup_europe_features", { userId: user.id })
    } else {
      await Task.run("setup_global_features", { userId: user.id })
    }
  }

  // Age verification for certain features
  if (inputs.age >= 18) {
    await Task.run("enable_full_features", { userId: user.id })
  } else {
    await Task.run("enable_restricted_features", { userId: user.id })
    await Task.run("notify_guardian", { email: inputs.guardianEmail })
  }

  // Final setup tasks
  Task.run("track_signup", {
    userId: user.id,
    source: inputs.signupSource,
    hasReferral: inputs.referralCode != null
  })
}
